---
layout: post
title: Linq 的一个小查询
date: 2011-02-22 10:22
comments: true
categories: []
---
<pre class="brush: csharp; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">  查询条件的很多种组合情况下,对于一个结果集的再次查询:</pre><pre class="brush: csharp; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">第一张写法就比较正常了.按道理说也是第一种写法比较符合正常的逻辑.可能就是出自一个差不多手的代码,而第二种呢?呵呵那就是比较的'考验'你的逻辑的严谨度了哦!嘻嘻<div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:0767317B-992E-4b12-91E0-4F059A8CECA8:3c23975f-565c-46ec-ab11-b1fb980f77ea" class="wlWriterEditableSmartContent">Technorati 标签: <a href="http://technorati.com/tags/linq+%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0" rel="tag">linq 匿名函数</a></div></pre>
<h1>1></h1><pre class="brush: csharp; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;"> var q = from c in _ticketsDataContext.V_ServiceResult
                        where c.MainAcountID == rec.MainAcountID
                        select new { c };

                if (rec.StartDate != null && rec.EndDate != null)
                {
                    q = q.Where(m => m.c.ServiceTime > rec.StartDate && m.c.ServiceTime < rec.EndDate.AddDays(1));
                }
                if (rec.SubAccountID > 0)
                {
                    q = q.Where(m => m.c.SubAcountID == rec.SubAccountID);
                }
                if (rec.ServiceContent != "" && rec.ServiceContent != "所有")
                {
                    q = q.Where(m => m.c.ServiceType == rec.ServiceContent);
                }
                if (rec.ContactType != "" && rec.ContactType != "所有")
                {
                    q = q.Where(m => m.c.ContactType == rec.ContactType);
                }
                if (rec.CustomerName != "" && rec.CustomerName != null)
                {
                    q = q.Where(m => m.c.CustomerName == rec.CustomerName);
                }
                TotalCount = q.Count();
                q = q.Skip((PageIndex - 1) * PageSize).Take(PageSize);
</pre><pre class="brush: csharp; auto-links: true; collapse: false; first-line: 1; gutter: true; html-script: false; light: false; ruler: false; smart-tabs: true; tab-size: 4; toolbar: true;">
