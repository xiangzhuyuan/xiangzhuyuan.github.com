---
layout: post
title: (续)我是怎么添加沪江每日一句的
date: 2011-09-23 12:59
comments: true
categories: []
---
<p>昨天写了沪江每日一句的重新显示.可是我还是发现了问题.到了今天了,他们那边的数据还是没有更新.英语的倒是更新到今天了.可是日语的还是没有,昨晚上过了12点我就发现了这个问题了,那时候我还以为是他们第二天白天才更新,结果今天都下午了还是22号的.不行,这样不行.我决定重新写,重新实现.</p> <p>我上他们的主页,发现主页上的倒是更新了.好像不是按一天为周期的.这样岂不是妙哉!我决定从它的主页把那个句子给耙过来.</p> <!--more--><div style="background: #fdfdfd; color: black"><u>HTML语言</u>: <a href="http://fayaa.com/code/view/22704/">Codee#22704</a></div> <div style="background-color: rgb(0,0,0); font-family: none, consolas, 'Lucida Console', 'Courier New'; color: rgb(192,192,192)" class="source"><span style="color: rgb(255,0,0); font-weight: bold">&lt;script </span><span style="color: rgb(255,0,0)">type=</span><span style="color: rgb(187,0,0)">"text/javascript"</span><span style="color: rgb(255,0,0); font-weight: bold">&gt;</span><br><span style="color: rgb(192,192,192)">$</span>(<span style="color: rgb(192,192,192)">document</span><span style="color: rgb(192,192,192)">).</span><span style="color: rgb(192,192,192)">ready</span>(<span style="color: rgb(255,0,0); font-weight: bold">function</span><span style="color: rgb(192,192,192)">(){</span>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <span style="color: rgb(192,192,192)">$</span>(<span style="color: rgb(187,0,0)">"#hjdict_daily_jp"</span><span style="color: rgb(192,192,192)">).</span><span style="color: rgb(192,192,192)">hide</span>();&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <span style="color: rgb(255,0,0); font-weight: bold">var</span> <span style="color: rgb(192,192,192)">content</span><span style="color: rgb(192,192,192)">=</span><span style="color: rgb(192,192,192)">$</span>(<span style="color: rgb(187,0,0)">"#<font style="background-color: #ffff00">daily_show</font>"</span><span style="color: rgb(192,192,192)">).</span><span style="color: rgb(192,192,192)">text</span>();&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <span style="color: rgb(255,0,0); font-weight: bold">var</span> <span style="color: rgb(192,192,192)">arr</span><span style="color: rgb(192,192,192)">=</span><span style="color: rgb(192,192,192)">content</span><span style="color: rgb(192,192,192)">.</span><span style="color: rgb(192,192,192)">split</span>(<span style="color: rgb(187,0,0)">"/"</span>);&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <span style="color: rgb(192,192,192)">$</span>(<span style="color: rgb(187,0,0)">"#jp"</span><span style="color: rgb(192,192,192)">).</span><span style="color: rgb(192,192,192)">text</span>(<span style="color: rgb(192,192,192)">arr</span><span style="color: rgb(192,192,192)">[</span><span style="color: rgb(192,192,192)">0</span><span style="color: rgb(192,192,192)">]);</span>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <span style="color: rgb(192,192,192)">$</span>(<span style="color: rgb(187,0,0)">"#chinese"</span><span style="color: rgb(192,192,192)">).</span><span style="color: rgb(192,192,192)">text</span>(<span style="color: rgb(192,192,192)">arr</span><span style="color: rgb(192,192,192)">[</span><span style="color: rgb(192,192,192)">1</span><span style="color: rgb(192,192,192)">]);</span><br><span style="color: rgb(192,192,192)">});</span><br><br><br><span style="color: rgb(255,0,0); font-weight: bold">&lt;/script&gt;</span><br><span style="color: rgb(255,0,0); font-weight: bold">&lt;div</span> <span style="color: rgb(255,0,0)">id=</span><span style="color: rgb(187,0,0)">"hide"</span> <span style="color: rgb(255,0,0)">style=</span><span style="color: rgb(187,0,0)">"display:none;"</span><span style="color: rgb(255,0,0); font-weight: bold">&gt;</span><br><span style="color: rgb(255,255,255)">&lt;?php</span><br><span style="color: rgb(255,255,255)">$url="http://jp.hjenglish.com/";</span><br><span style="color: rgb(255,255,255)">$html= file_get_contents( $url );</span><br><span style="color: rgb(255,255,255)">$last=trim($html);</span><br><span style="color: rgb(255,255,255)">$start=strpos($last,"&lt;div id=\"daily_show\" &gt;");</span><br><br><br><span style="color: rgb(255,255,255)">$div=strstr($html,'&lt;/body&gt;');</span><br><span style="color: rgb(255,255,255)">//从想要的地方开始</span><br><span style="color: rgb(255,255,255)">$final=substr($last,$start);</span><br><span style="color: rgb(255,255,255)">//位置</span><br><span style="color: rgb(255,255,255)">$end=strpos($final,"&lt;!--end: daily_show --&gt;"); </span><br><br><span style="color: rgb(255,255,255)">$final=substr($final,0,$end);</span><br><span style="color: rgb(255,255,255)">$final=str_replace("&lt;/body&gt;","",$final);</span><br><span style="color: rgb(255,255,255)">$final=str_replace("&lt;/html&gt;","",$final);</span><br><span style="color: rgb(255,255,255)">echo $final;</span><br><span style="color: rgb(255,255,255)">?&gt;</span><br><span style="color: rgb(255,0,0); font-weight: bold">&lt;/div&gt;</span><br></div> <p>&nbsp;</p> <p>其实很简单的,就是我还是按照之前的逻辑,只不过之前是他们用js就把那个对象给做好了,然后我就用js去取值然后再赋值给我的对象.</p> <p>现在我还是这样,我把获取的网页源代码截取,只留下我想要的那部分.</p> <div style="background: #fdfdfd; color: black"><u>HTML语言</u>: <a href="http://fayaa.com/code/view/22705/">Codee#22705</a></div> <div style="background-color: rgb(0,0,0); font-family: none, consolas, 'Lucida Console', 'Courier New'; color: rgb(192,192,192)" class="source"><span style="color: rgb(255,0,0); font-weight: bold">&lt;div</span> <span style="color: rgb(255,0,0)">id=</span><span style="color: rgb(187,0,0)">"daily_show"</span><span style="color: rgb(255,0,0); font-weight: bold">&gt;</span><br>&nbsp;&nbsp;&nbsp; <span style="color: rgb(255,0,0); font-weight: bold">&lt;a</span> <span style="color: rgb(255,0,0)">href=</span><span style="color: rgb(187,0,0)">"http://bulo.hjenglish.com/app/redirect?source=jp2010&amp;amp;type=2&amp;amp;returnurl=http://bulo.hjenglish.com/</span></div> <div style="background-color: rgb(0,0,0); font-family: none, consolas, 'Lucida Console', 'Courier New'; color: rgb(192,192,192)" class="source"><span style="color: rgb(187,0,0)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; app/day/sentence_jp/"</span> <span style="color: rgb(255,0,0)">id=</span><span style="color: rgb(187,0,0)">"aDailySentence"</span> <span style="color: rgb(255,0,0)">target=</span><span style="color: rgb(187,0,0)">"_blank"</span> <span style="color: rgb(255,0,0)">onclick=</span><span style="color: rgb(187,0,0)">"DoRecord(this,'宽屏首页_每日一句')"</span><span style="color: rgb(255,0,0); font-weight: bold">&gt;</span>これからサンプルをお届けします。 / 等会我把样品发给你。 <span style="color: rgb(255,0,0); font-weight: bold">&lt;/a&gt;</span><br><span style="color: rgb(255,0,0); font-weight: bold">&lt;/div&gt;</span><span style="color: rgb(105,105,105)">&lt;!--end: daily_show --&gt;</span><br></div> <p>&nbsp;</p> <p>然后我还是把它给隐藏了.然后去显示我自己的.</p> <p>这样实现可能有点不是很巧妙,可是也没有办法,数据室人家的.不过接下来我又有了新的想法:那就是有时候我不能够保证看完了就记住了,或者我哪天都没有去访问博客就没有看见这个句子.我需要把他保存下来.虽然沪江提供打包下载.可是我为什么不能自己写个代码每天自动保存呢,然后我可以拿这些数据来做一些事情了,要想打包下载的数据和数据库里有序存储的数据还是有区别的.我可以用这些展开很多的服务啊.</p>
