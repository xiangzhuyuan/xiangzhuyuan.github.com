---
layout: post
title: 我是怎么添加沪江日语每日一句的
date: 2011-09-23 02:12
comments: true
categories: []
---
<span style="font-family: 微软雅黑;">今天突然想起了沪江日语有个</span><a href="http://dict.hjenglish.com/help/dailysentence/"><span style="font-family: 微软雅黑;">每日一句</span></a><span style="font-family: 微软雅黑;">这样的一个服务,心想把它添加到自己的博客呗,也算是能够每天学一句日语.想法不错吧.</span>

<span style="font-family: 微软雅黑;">不过比较让我不满意的就是它的最终实现的效果有点难看,很难看在我看来.</span>

<span style="font-family: 微软雅黑;">首先来看看到底他们是怎么实现的吧.</span>
<div style="background: #fdfdfd; color: black;"><span style="text-decoration: underline;">HTML语言</span>: <a href="http://fayaa.com/code/view/22692/">Codee#22692</a></div>
<div class="source" style="background-color: #000000; font-family: none, consolas, 'Lucida Console', 'Courier New'; color: #e0eee0;"><span style="color: #7c7268;">&lt;!-- 每日一句JS引用 开始 --&gt;</span>
<span style="color: #90ee90;">&lt;span</span> <span style="color: #9bcd9b;">id=</span><span style="color: #80a0ff;">"hjdict_daily_jp"</span><span style="color: #90ee90;">&gt;</span>
<span style="color: #90ee90;">&lt;a</span> <span style="color: #9bcd9b;">href=</span><span style="color: #80a0ff;">"http://dict.yeshj.com"</span> <span style="color: #9bcd9b;">target=</span><span style="color: #80a0ff;">"_blank"</span> <span style="color: #9bcd9b;">title=</span><span style="color: #80a0ff;">"沪江小D, 在线词典, 英语学习, 查单词"</span><span style="color: #90ee90;">&gt;</span>跟小D每日学口语<span style="color: #90ee90;">&lt;/a&gt;</span>
<span style="color: #90ee90;">&lt;/span&gt;</span>
<span style="color: #90ee90;">&lt;script </span><span style="color: #9bcd9b;">type=</span><span style="color: #80a0ff;">"text/javascript"</span> <span style="color: #9bcd9b;">src=</span><span style="color: #80a0ff;">"http://dict.yeshj.com/js_daily_2.js"</span><span style="color: #90ee90;">&gt;&lt;/script&gt;</span>
<span style="color: #7c7268;">&lt;!-- 每日一句JS引用 结束 –&gt;</span></div>
<span style="font-family: 微软雅黑;">你的做法就是在你想要显示它的地方添加这些代码.其实就是关键的那个js文件在操作那个<strong>id</strong>为<strong>hjdict_daily_jp</strong>的span标签.然后在span里添加html代码加以显示.</span>

<span style="font-family: 微软雅黑;"><!--more--></span>

<span style="font-family: 微软雅黑;">我们来看看这个js是怎么写的吧.这里有点意思,就是一般的js文件直接请求会在浏览器里显示出来的,可是当我请求<strong><a href="http://dict.yeshj.com/js_daily_2.js">http://dict.yeshj.com/js_daily_2.js</a></strong>这个文件的时候我却没有看见具体的代码,为什么呢?其实没有什么高深的东西,当我右键查看源代码就发现了猫腻,他们把这个文件假注释了.</span>
<div style="background: #fdfdfd; color: black;"><span style="text-decoration: underline;">JavaScript语言</span>: <a href="http://fayaa.com/code/view/22688/">Codee#22688</a></div>
<div class="source" style="background-color: #000000; font-family: '[object HTMLOptionElement]', consolas, 'Lucida Console', 'Courier New'; color: #e0eee0;"><span style="color: #7c7268;">&lt;!--</span>
<span style="color: #add8e6;">function</span> <span style="color: #e0eee0;">GetFlashCode</span>(<span style="color: #e0eee0;">id</span><span style="color: #e0eee0;">,</span> <span style="color: #e0eee0;">playerfile</span><span style="color: #e0eee0;">,</span> <span style="color: #e0eee0;">flashvers</span> <span style="color: #e0eee0;">,</span><span style="color: #e0eee0;">width</span><span style="color: #e0eee0;">,</span> <span style="color: #e0eee0;">height</span><span style="color: #e0eee0;">,</span> <span style="color: #e0eee0;">transparent</span><span style="color: #e0eee0;">){</span>       <span style="color: #90ee90;">if</span>(<span style="color: #e0eee0;">transparent</span> <span style="color: #e0eee0;">==</span> <span style="color: #90ee90;">true</span><span style="color: #e0eee0;">){</span><span style="color: #e0eee0;">transparent</span> <span style="color: #e0eee0;">=</span> <span style="color: #80a0ff;">"window"</span>;

<span style="color: #e0eee0;">}</span><span style="color: #90ee90;">else</span><span style="color: #e0eee0;">{</span>

<span style="color: #e0eee0;">transparent</span><span style="color: #e0eee0;">=</span><span style="color: #80a0ff;">"transparent"</span>;

<span style="color: #e0eee0;">}</span>
<span style="color: #add8e6;">var</span> <span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">=</span><span style="color: #80a0ff;">"&lt;object cl"</span><span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"assid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' code"</span><span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"base='http://fpdownload.macromedia.com/</span>

</div>
<div class="source" style="background-color: #000000; font-family: '[object HTMLOptionElement]', consolas, 'Lucida Console', 'Courier New'; color: #e0eee0;"><span style="color: #80a0ff;">                pub/shockwave/cabs/flash/swflash.cab#version=8,0,22,0'"</span>;       <span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"width='"</span><span style="color: #e0eee0;">+</span> <span style="color: #e0eee0;">width</span><span style="color: #e0eee0;">+</span> <span style="color: #80a0ff;">"' height='"</span><span style="color: #e0eee0;">+</span> <span style="color: #e0eee0;">height</span><span style="color: #e0eee0;">+</span> <span style="color: #80a0ff;">"' id='"</span><span style="color: #e0eee0;">+</span> <span style="color: #e0eee0;">id</span> <span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' align='middle' &gt;"</span>;<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;param name='allowScriptAccess' value='always' /&gt;"</span>;

<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;param name='movie' value='"</span><span style="color: #e0eee0;">+</span><span style="color: #e0eee0;">playerfile</span><span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' /&gt;"</span>;

<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;param name='quality' value='high' /&gt;"</span>;

<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;param name='scale' value='noScale' /&gt;"</span>;

<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;param name='wmode' value='"</span><span style="color: #e0eee0;">+</span><span style="color: #e0eee0;">transparent</span><span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' /&gt;"</span>;

<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;param name='flashvars' value='"</span><span style="color: #e0eee0;">+</span><span style="color: #e0eee0;">flashvers</span><span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' /&gt;"</span>;

<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;embed src='"</span><span style="color: #e0eee0;">+</span><span style="color: #e0eee0;">playerfile</span><span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' quality='high' scale='noScale' bgcolor='#ffffff' width='"</span><span style="color: #e0eee0;">+</span> <span style="color: #e0eee0;">width</span><span style="color: #e0eee0;">+</span> <span style="color: #80a0ff;">"' height='"</span><span style="color: #e0eee0;">+</span> <span style="color: #e0eee0;">height</span><span style="color: #e0eee0;">+</span> <span style="color: #80a0ff;">"' flashvars='"</span><span style="color: #e0eee0;">+</span><span style="color: #e0eee0;">flashvers</span><span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' id='"</span><span style="color: #e0eee0;">+</span> <span style="color: #e0eee0;">id</span> <span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' name='"</span><span style="color: #e0eee0;">+</span> <span style="color: #e0eee0;">id</span> <span style="color: #e0eee0;">+</span><span style="color: #80a0ff;">"' align='middle' allowScriptAccess='always' type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/go/getflashplayer'/&gt;"</span>;

<span style="color: #e0eee0;">str</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">"&lt;/object&gt;"</span>;

<span style="color: #90ee90;">return</span> <span style="color: #e0eee0;">str</span>;

<span style="color: #e0eee0;">}</span>

<span style="color: #add8e6;">var</span> <span style="color: #e0eee0;">hjd_html_jp</span> <span style="color: #e0eee0;">=</span><span style="color: #80a0ff;">"&lt;a href='http://dict.hjenglish.com/getdict.aspx#dailysentence' target='_blank'&gt;[9.22]&lt;/a&gt;"</span>;

<span style="color: #e0eee0;">hjd_html_jp</span><span style="color: #e0eee0;">+=</span>    <span style="color: #e0eee0;">GetFlashCode</span>(<span style="color: #80a0ff;">"daily_sentence"</span><span style="color: #e0eee0;">+</span><span style="color: #4eee94;">Math</span><span style="color: #e0eee0;">.</span><span style="color: #e0eee0;">random</span><span style="color: #e0eee0;">(),</span><span style="color: #80a0ff;">"http://dict.hjenglish.com/speaker_sent.swf"</span><span style="color: #e0eee0;">,</span> <span style="color: #80a0ff;">"w=http://f1.hjfile.cn/daily/jp/201109/17.mp3"</span><span style="color: #e0eee0;">,</span> <span style="color: #00ffff;">16</span><span style="color: #e0eee0;">,</span><span style="color: #00ffff;">18</span><span style="color: #e0eee0;">,</span><span style="color: #90ee90;">false</span>);

<span style="color: #e0eee0;">hjd_html_jp</span><span style="color: #e0eee0;">+=</span><span style="color: #80a0ff;">" &lt;a href='http://bulo.yeshj.com/menu/1583/item/466844/' target='_blank' title='[&amp;#28857;&amp;#20987;&amp;#21442;&amp;#19982;&amp;#35752;&amp;#35770;]' &gt;&lt;<span style="background-color: #ffff00;">font style='font-family:MingLiU'&gt;</span>&amp;#22909;&amp;#12365;&amp;#12394;&amp;#12425;&amp;#12289; &amp;#12385;&amp;#12419;&amp;#12435;&amp;#12392; &amp;#35328;&amp;#12431;&amp;#12394;&amp;#12356;&amp;#12392; &amp;#25613;&amp;#12377;&amp;#12427;&amp;#12424;&amp;#12290;&lt;/font&gt; /&amp;#21916;&amp;#27426;&amp;#23545;</span>

</div>
<div class="source" style="background-color: #000000; font-family: '[object HTMLOptionElement]', consolas, 'Lucida Console', 'Courier New'; color: #e0eee0;"><span style="color: #80a0ff;">&amp;#26041;&amp;#21364;&amp;#19981;&amp;#34920;&amp;#30333;&amp;#30340;&amp;#35805;&amp;#65292;&amp;#25439;</span></div>
<div class="source" style="background-color: #000000; font-family: '[object HTMLOptionElement]', consolas, 'Lucida Console', 'Courier New'; color: #e0eee0;"><span style="color: #80a0ff;">&amp;#22833;&amp;#30340;&amp;#26159;&amp;#20320;&amp;#33258;&amp;#24049;&amp;#12290; &lt;/a&gt; "</span>;   <span style="color: #7c7268;">//</span><span style="color: #4eee94;">document</span><span style="color: #e0eee0;">.</span><span style="color: #e0eee0;">getElementById</span>(<span style="color: #80a0ff;">"hjdict_daily_jp"</span><span style="color: #e0eee0;">).</span><span style="color: #e0eee0;">innerHTML</span><span style="color: #e0eee0;">=</span><span style="color: #e0eee0;">hjd_html_jp</span>;

<span style="color: #7c7268;">//--&gt;</span>

</div>
<span style="font-family: 微软雅黑;">上面的代码就是他们处理过的js代码,其实没有什么含量的东西.就是返回了一句日语,然后添加一个播放器,地址为一个mp3文件.</span>

<span style="font-family: 微软雅黑;">本来就是直接添加他给的代码就ok了.可是让我不舒服的地方是什么呢:</span>

<span style="font-family: 微软雅黑;">1.我不需要知道它怎么说,而且往往由于网速等缘故也听不到.</span>

<span style="font-family: 微软雅黑;">2.这个就是最主要的原因,因为他们把日文的显示字体竟然搞成了<strong>mingliu(</strong>上面代码里的黄色显示部分),最受不了的就是看不是正统字体的日文,太难受了.</span>

<span style="font-family: 微软雅黑;">所以我想把它改一改,开始的时候想法是用写程序的办法把那个字符串给截断了,就要那部分文字.可是后来我打消了这个想法,因为这样我认为不专业,竟然人家都是用js做,我再用程序写,岂不是大炮打蚊子?所以我决定同样用js来搞定它.</span>

<span style="font-family: 微软雅黑;">说道js,那当然要用jQuery了啊.我知道一个比较酷的</span><a href="http://scriptsrc.net/"><span style="font-family: 微软雅黑;">网站</span></a><span style="font-family: 微软雅黑;">,这个站真是太帅了.它直接提供最火的最新的js库.</span>

<a href="http://www.yyxzy.org/wp-content/uploads/2011/09/scriptsrc.net_.jpg"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="scriptsrc.net" src="http://www.yyxzy.org/wp-content/uploads/2011/09/scriptsrc.net_thumb.jpg" alt="scriptsrc.net" width="757" height="659" border="0" /></a>

<span style="font-family: 微软雅黑;">操作极为简单,点击copy,然后回到你要引用的页面paste,就ok!</span>

<span style="font-family: 微软雅黑;">接下来就是显示我想要的最后的结果了:</span>

<span style="font-family: 微软雅黑;">1.你可以把他们要你添加的代码放在任何地方,id不能改,因为它要根据id找到这个对象,样式我们能够改吧,直接添加”display:none;”隐藏了.</span>

<span style="font-family: 微软雅黑;">2.在你想要显示的地方添加你直接的表签.我用了3个span,第一个用来说明出处,第二个显示日语,第三个显示汉语翻译.为什么要分开呢,因为我要用不同的字体来显示他们.</span>
<div style="background: #fdfdfd; color: black;"><span style="text-decoration: underline;">HTML语言</span>: <a href="http://fayaa.com/code/view/22690/">Codee#22690</a></div>
<div class="source" style="background-color: #000000; font-family: none, consolas, 'Lucida Console', 'Courier New'; color: #e0eee0;"><span style="color: #90ee90;">&lt;div</span> <span style="color: #9bcd9b;">style=</span><span style="color: #80a0ff;">"margin: 0px auto 10px auto;border: 1px dashed darkBlue;line-height: 1em;"</span><span style="color: #90ee90;">&gt;</span>
<span style="color: #90ee90;">&lt;span&gt;&lt;a</span> <span style="color: #9bcd9b;">href=</span><span style="color: #80a0ff;">"http://jp.hjenglish.com/"</span><span style="color: #90ee90;">&gt;</span>来自于沪江日语网<span style="color: #90ee90;">&lt;/a&gt;</span>:<span style="color: #999999;">&amp;nbsp;</span><span style="color: #90ee90;">&lt;/span&gt;</span>
<span style="color: #90ee90;">&lt;span</span> <span style="color: #9bcd9b;">id=</span><span style="color: #80a0ff;">"jp"</span> <span style="color: #9bcd9b;">style=</span><span style="color: #80a0ff;">"font: 1em bold 'ms mincho';float: none;"</span><span style="color: #90ee90;">&gt;&lt;/span&gt;</span>
<span style="color: #90ee90;">&lt;span</span> <span style="color: #9bcd9b;">id=</span><span style="color: #80a0ff;">"chinese"</span><span style="color: #90ee90;">&gt;&lt;/span&gt;</span>
<span style="color: #90ee90;">&lt;/div&gt;</span></div>
<span style="font-family: 微软雅黑;">3.到这里就是最后一步了,直接获取隐藏了的标签的文字,然后拿来处理了赋值给我自己的标签,就ok.就这么简单.</span>
<div style="background: #fdfdfd; color: black;"><span style="text-decoration: underline;">JavaScript语言</span>: <a href="http://fayaa.com/code/view/22691/">Codee#22691</a></div>
<div class="source" style="background-color: #000000; font-family: none, consolas, 'Lucida Console', 'Courier New'; color: #e0eee0;"><span style="color: #e0eee0;">&lt;</span><span style="color: #e0eee0;">script</span> <span style="color: #e0eee0;">type</span><span style="color: #e0eee0;">=</span><span style="color: #80a0ff;">"text/javascript"</span><span style="color: #e0eee0;">&gt;</span>
<span style="color: #e0eee0;">$</span>(<span style="color: #4eee94;">document</span><span style="color: #e0eee0;">).</span><span style="color: #e0eee0;">ready</span>(<span style="color: #add8e6;">function</span><span style="color: #e0eee0;">(){</span>
<span style="color: #e0eee0;">$</span>(<span style="color: #80a0ff;">"#hjdict_daily_jp"</span><span style="color: #e0eee0;">).</span><span style="color: #e0eee0;">hide</span>();
<span style="color: #add8e6;">var</span> <span style="color: #e0eee0;">content</span><span style="color: #e0eee0;">=</span><span style="color: #e0eee0;">$</span>(<span style="color: #80a0ff;">"#hjdict_daily_jp"</span><span style="color: #e0eee0;">).</span><span style="color: #e0eee0;">text</span>();
<span style="color: #add8e6;">var</span> <span style="color: #e0eee0;">arr</span><span style="color: #e0eee0;">=</span><span style="color: #e0eee0;">content</span><span style="color: #e0eee0;">.</span><span style="color: #e0eee0;">split</span>(<span style="color: #80a0ff;">"/"</span>);
<span style="color: #e0eee0;">$</span>(<span style="color: #80a0ff;">"#jp"</span><span style="color: #e0eee0;">).</span><span style="color: #e0eee0;">text</span>(<span style="color: #e0eee0;">arr</span><span style="color: #e0eee0;">[</span><span style="color: #00ffff;">0</span><span style="color: #e0eee0;">]);</span>
<span style="color: #e0eee0;">$</span>(<span style="color: #80a0ff;">"#chinese"</span><span style="color: #e0eee0;">).</span><span style="color: #e0eee0;">text</span>(<span style="color: #e0eee0;">arr</span><span style="color: #e0eee0;">[</span><span style="color: #00ffff;">1</span><span style="color: #e0eee0;">]);</span>
<span style="color: #e0eee0;">});</span>
<span style="color: #e0eee0;">&lt;</span><span style="color: #e0eee0;">/script&gt;</span></div>
&nbsp;

Done!<a href="http://www.yyxzy.org/">去看看吧</a>

<a href="http://www.yyxzy.org/wp-content/uploads/2011/09/52smap.jpg"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="52smap" src="http://www.yyxzy.org/wp-content/uploads/2011/09/52smap_thumb.jpg" alt="52smap" width="1005" height="267" border="0" /></a>
